var video,IMAGE=document.getElementById("bbox-image"),cropper=void 0;function captureImage(){var e=document.createElement("canvas");e.width=1280,e.height=720,e.getContext("2d").drawImage(video,0,0,e.width,e.height),e.toBlob(function(e){IMAGE.src=URL.createObjectURL(e),void 0!==cropper&&cropper.destroy(),cropper=new Cropper(IMAGE,{viewMode:1,movable:!1,zoomable:!1,rotatable:!1,scalable:!1,autoCropArea:.25,crop:function(e){let t=e.detail;$("#dataX").val(Math.round(t.x)),$("#dataY").val(Math.round(t.y)),$("#dataHeight").val(Math.round(t.height)),$("#dataWidth").val(Math.round(t.width))}})})}(function(){var e,t,a,o;e=function(e){return $("#btnSubmit").attr("disabled",!0),alert("Camera is not supported"),console.log("Rejected",e)},t=function(e){try{video.srcObject=e}catch{video.src=webkitURL.createObjectURL(e)}if(video.play(),"WebSocket"in window||"MozWebSocket"in window){var t=window.location.href.split(":")[0];(o="https"===t?new WebSocket("wss://"+location.host+"/ws"):new WebSocket("ws://"+location.host+"/ws")).onopen=function(){return console.log("Opened websocket")},o.onmessage=function(e){$("#cam").attr("src","data:image/jpg;base64,"+e.data)}}else alert("Can not conect to server!");return setInterval(a,250)},a=function(){var e=document.createElement("canvas");return e.width=1280,e.height=720,e.getContext("2d").drawImage(video,0,0,e.width,e.height),e.toBlob(function(e){return o.send(e)},"image/jpeg")},video=document.querySelector("video"),navigator.getMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,navigator.getMedia({video:!0,audio:!1},t,e)}).call(this),$("#algorithm").on("change",function(){this.value;parseInt($(this).find(":selected").attr("data-bb"))?$(".bbox-container").show():($(".bbox-container").hide(),IMAGE.src="",void 0!==cropper&&cropper.destroy())}),$("#categories").submit(function(e){e.preventDefault(),$("#divSpinner").fadeIn("slow");var t=$(this),a=t.attr("action");$.ajax({type:"POST",url:a,data:t.serialize(),success:function(e){location.reload()}})});