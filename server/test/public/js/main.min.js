var video,IMAGE=document.getElementById("bbox-image"),cropper=void 0,send=!0;function captureImage(){var e=document.createElement("canvas");e.width=1280,e.height=720,e.getContext("2d").drawImage(video,0,0,e.width,e.height),e.toBlob(function(e){IMAGE.src=URL.createObjectURL(e),void 0!==cropper&&cropper.destroy(),cropper=new Cropper(IMAGE,{viewMode:1,movable:!1,zoomable:!1,rotatable:!1,scalable:!1,autoCropArea:.25,crop:function(e){let t=e.detail;$("#dataX").val(Math.round(t.x)),$("#dataY").val(Math.round(t.y)),$("#dataHeight").val(Math.round(t.height)),$("#dataWidth").val(Math.round(t.width))}})})}(function(){var e,t,o,n;e=function(e){return $("#btnSubmit").attr("disabled",!0),alert("Camera is not supported"),console.log("Rejected",e)},t=function(e){try{video.srcObject=e}catch{video.src=webkitURL.createObjectURL(e)}return video.play(),(n=io.connect(window.location.href)).on("connect",function(){return n.on("clientInfo",function(e){$("#clientID").val(e)}),console.log("Connected server")}),n.on("message",function(e){$("#divSpinner").is(":visible")&&$("#divSpinner").fadeOut("slow"),$("#cam").attr("src","data:image/jpg;base64,"+e)}),n.on("disconnect",function(){return send=!1,alert("Disconnected from server"),console.log("Disconnected from server")}),n.on("connect_error",function(){alert("Can not connect to server!"),n.disconnect()}),setInterval(o,125)},o=function(){var e=document.createElement("canvas");return e.width=1280,e.height=720,e.getContext("2d").drawImage(video,0,0,e.width,e.height),e.toBlob(function(e){send&&n.emit("message",e)},"image/jpeg")},video=document.querySelector("video"),navigator.getMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,navigator.getMedia({video:!0,audio:!1},t,e)}).call(this),$("#algorithm").on("change",function(){this.value;parseInt($(this).find(":selected").attr("data-bb"))?$(".bbox-container").show():($(".bbox-container").hide(),IMAGE.src="",void 0!==cropper&&cropper.destroy())}),$("#categories").submit(function(e){e.preventDefault(),$("#divSpinner").fadeIn("slow");var t=$(this),o=t.attr("action");$.ajax({type:"POST",url:o,data:t.serialize(),success:function(e){console.log("success"),$(".bbox-container").is(":visible")&&$("html, body").animate({scrollTop:$(document).height()/3},"slow")}})});